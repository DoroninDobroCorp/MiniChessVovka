# Mini Chess 6x6 Crazyhouse - Сильный AI

## Описание

Это приложение для игры в Mini Chess 6x6 с правилами Crazyhouse (захваченные фигуры можно ставить обратно на доску).

## Улучшения AI для победы над топами

### Реализованные техники:

1. **Глубокий поиск (Depth 16)**
   - AI анализирует позиции на глубину 16 полуходов
   - Это позволяет видеть комбинации на 8 ходов вперёд

2. **Alpha-Beta отсечение с улучшениями**
   - Transposition Table (TT) - кэширование оценок позиций
   - Iterative Deepening - постепенное углубление поиска
   - Move Cache Database - сохранение лучших ходов между сессиями

3. **Продвинутая сортировка ходов**
   - TT move (ход из таблицы транспозиций) - приоритет 1
   - Killer moves (ходы, вызвавшие отсечение) - приоритет 2
   - MVV-LVA (самая ценная жертва - наименее ценный агрессор) - для взятий
   - History heuristic - статистика успешных ходов

4. **Quiescence Search (глубина 4)**
   - Дополнительный поиск тактических последовательностей (взятий и превращений)
   - Предотвращает "horizon effect"

5. **Улучшенная оценочная функция**
   - Материал с учётом фигур в руке (Crazyhouse-специфично)
   - Бонус за дроп-угрозы (+25 за каждую фигуру в руке)
   - Контроль центра (+15 за фигуру в центре)
   - Безопасность короля (+8 за защитников рядом)
   - Пешечная структура (+5 за связанные пешки)
   - Проходные пешки (бонус увеличивается при приближении к превращению)
   - Фазы игры (opening/endgame) - разная оценка короля

6. **Ценности фигур оптимизированы для Crazyhouse**
   - Фигуры в руке ценнее, чем на доске:
     - Пешка: 100 на доске, 150 в руке
     - Конь: 320 на доске, 400 в руке
     - Слон: 330 на доске, 410 в руке
     - Ладья: 500 на доске, 650 в руке
     - Ферзь: 900 на доске, 1000 в руке

## Запуск

### GUI версия (с графическим интерфейсом):
```bash
./venv/bin/python main.py
```

### Тестовая версия (AI vs AI в консоли):
```bash
./venv/bin/python test_ai.py
```

## Настройка силы AI

В файле `gamestate.py` (строка 37):
```python
self.ai_depth = 16  # Глубина поиска
```

- Глубина 8-10: быстро, средняя сила
- Глубина 12-14: нормально, хорошая сила
- **Глубина 16: медленно, очень сильная игра** (текущая настройка)
- Глубина 18+: очень медленно, максимальная сила

## Особенности

- **Кэш ходов**: сохраняется в `move_cache.db` - AI запоминает позиции между играми
- **Killer moves**: AI запоминает ходы, вызвавшие отсечения
- **History heuristic**: статистика успешности ходов
- **Parallel search**: использует все ядра процессора

## Стратегия игры AI

1. Агрессивно захватывает фигуры для пополнения руки
2. Использует дропы для создания тактических угроз
3. Контролирует центр доски
4. Защищает короля в opening, активирует в endgame
5. Ищет форсированные варианты (мат, выигрыш материала)

## Производительность

- Ходы из кэша: мгновенно (<0.01с)
- Новые позиции (depth 16): 10-60 секунд в зависимости от сложности
- Использует 7 процессов для параллельных вычислений

## Как победить топов

AI настроен на максимальную тактическую силу:
- Глубокий расчёт вариантов
- Crazyhouse-специфичная оценка (дропы очень важны!)
- Агрессивная игра с использованием захваченных фигур
- Точная оценка позиций

Можно играть медленно - AI не ограничен временем и всегда найдёт лучший ход.
